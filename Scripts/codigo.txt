data=read.csv("C:/Users/ADMIN/Documents/GitHub/TA1_Administracion/Scripts/data_set/hotel_bookings.csv",header= TRUE, sep = ",")
head(data)
names(data)
str(data)
summary(data)

#Tabla 1: Tipo de clientes por año
TipoDeClientesPorHotel=table(data$hotel,data$customer_type)

barplot(TipoDeClientesPorHotel,
        main="Tipo de lientes en cada hotel por año",
        col=c("red","blue"),legend=c("City hotel","Resort hotel"),
        xlab = ("tipo clientes"),ylab = ("numero de clientes"),args.legend = list(x = "topright",inset = c(- 0.05, -0.25)))

#tabla 2: clientes en cada hotel por año
ClientesPorHotel=table(data$hotel,data$arrival_date_year)
barplot(ClientesPorHotel,
        main="Clientes en cada hotel por año",
        col=c("red","blue"),legend=c("City hotel","Resort hotel"),
        xlab = ("año"),ylab = ("numero de clientes"),args.legend = list(x = "topright",inset = c(- 0.05, -0.25)))

#tabla 3: numero de cancelados por año

canceladosPorAnio=table(data$is_canceled,data$arrival_date_year)
barplot(canceladosPorAnio,
        main="Reservas por año",
        col=c("red","blue"),legend=c("no cancelado","cancelado"),
        xlab = ("año"),ylab = ("numero de reservas"),args.legend = list(x = "topright",inset = c(- 0.05, -0.25)))

#tabla 4 estacionamientos
estacionamiento=table(data$required_car_parking_spaces)
density(data$required_car_parking_spaces)
plot(estacionamiento,main="estacionamientos requeridos",xlab=("estacionamientos pedidos"),ylab = ("estacionamientos"))


#tabla 5 cancelaciones por mes
library(dplyr)
data$is_canceled==0
cancelados<-data%>%filter(is_canceled!=0)
tablaCancelado<-table(cancelados$arrival_date_month)
pie(tablaCancelado)